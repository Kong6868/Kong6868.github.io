<!-- <h1><img alt="Pathways" src="pathways.png", width="70">&nbsp;GlycoMaple
<img alt="Pathways" src="glyco_maple_icon.png", width="70"></h1> -->

<p>Please input .csv file (Gene ID, TPM value). Do you need <a href="./app/public/test_seq.csv">sample</a> files?</p>

<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>GlycoMaple</title>

  <script src="./file/jquery.min.js"></script>

  <link rel="stylesheet" href="./file/bootstrap.min.css">
  <script src="./file/popper.min.js"></script>
  <script src="./file/bootstrap.min.js"></script>

  <link rel="stylesheet" href="./file/bootstrap-table.min.css">
  <script src="./file/bootstrap-table.min.js"></script>
  <script src="./file/bootstrap-table-zh-CN.min.js"></script>

  <script src="./file/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="./file/jquery-ui.css">
  <script src="./file/jquery.mousewheel.min.js"></script>

  <!-- <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/d3@4.13.0/build/d3.min.js" charset="utf-8"></script>
  <script src="https://cdn.jsdelivr.net/npm/taucharts@2/dist/taucharts.min.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/taucharts@2/dist/taucharts.min.css"> -->
  <script src="./file/plotly-latest.min.js"></script>


</head>

<svg width="60" height="30" viewBox="0,0,60,30">
  <defs>
    <symbol id="legend">
      <polygon points="20,20 30,15 20,10" />
      <rect x="0" y="15" width="20" height="1" />
    </symbol>
  </defs>
</svg>

<body>
  <div class="row">
    <div class="col-md-4 col-sm-12" style="display:inline-flex; background-color:#f2e6ff">
      <form id='form'>
        <div class="form-group">
          <input type="file" accept="text/csv" class="form-control-file" id="seqFile" />
        </div>
        <button type="button" class="btn btn-primary" value="view" onclick="fileSubmit();" style="">Submit</button>
        <div id="file_loading" style="display:none">
          <div class="cv-spinner">
            <span class="spinner"></span>
          </div>
        </div>
      </form>
    </div>
    <div class="col-md-4 col-sm-12 bg-light">
      <label for="hpa_cells">HPA(cell): </label><br>
      <select id="hpa_cells"></select>
      <button type="button" class="btn btn-primary" value="cells" onclick="hpaAdd(this.value);" style="">Add</button>
    </div>
    <!-- </div>
  <div class="row">
    <div class="col-4"></div> -->
    <div class="col-md-4 col-sm-12 bg-light">
      <label for="hpa_tissue">HPA(tissue): </label><br>
      <select id="hpa_tissue"></select>
      <button type="button" class="btn btn-primary" value="tissue" onclick="hpaAdd(this.value);" style="">Add</button>
      <!-- <span onclick="deleteTab()"> ×</span> -->
    </div>
  </div>

  <div class="row">
    <div class="col-md-4 col-xs-12 bg-light"><br>
      <label for="complex_ope">Complex: </label>
      <select id="complex_ope">
        <option selected="selected" value="min">Min</option>
        <option value="ave">Ave</option>
        <option value="max">Max</option>
      </select><br>
      <label for="overlap_ope">Overlap: </label>
      <select id="overlap_ope">
        <option selected="selected" value="max">Max</option>
        <option value="min">Min</option>
        <option value="max">Max</option>
        <option value="sum">Sum</option>
      </select><br><br>
      <p>If two or more tabs are open in the diagram, two datasets can be compared using the Compare button below.</p>
      <button type="button" class="btn btn-primary" id="compare_button">Compare</button>
      <div class="modal">
        <div class="modal_bg modal-close"></div>
        <div class="modal_content" id="compare_window">
          <p style="text-align: right"><a class="modal-close" href="">×</a></p>
          <p>Sample A vs Sample B</p>
          <p>x = (TPM<sub>A</sub> + 1) / (TPM<sub>B</sub> + 1)</p>
          <label for="SampleA">Sample A: </label>
          <select id="SampleA"></select><br>
          <label for="SampleB">Sample B: </label>
          <select id="SampleB"></select><br><br>
          <label for="complex_com">Complex: </label>
          <select id="complex_com">
            <option selected="selected" value="min">Min</option>
            <option value="ave">Ave</option>
            <option value="max">Max</option>
          </select><br>
          <label for="overlap_com">Overlap: </label>
          <select id="overlap_com">
            <option selected="selected" value="max">Max</option>
            <option value="min">Min</option>
            <option value="max">Max</option>
            <option value="sum">Sum</option>
          </select><br><br>
          <table class="table">
            <tbody>
              <tr>
                <td></td>
                <td> x < </td>
                <td><input id="down_value" type="number" min="0" value="0.5" /></td>
                <td>
                  <svg width="60" height="40" viewBox="0,0,60,30">
                    <use xlink:href="#legend" class="down" />
                  </svg>
                </td>
              </tr>
              <tr>
                <td></td>
                <td> x ≧ </td>
                <td><input id="up_value" type="number" min="0" value="2" /></td>
                <td>
                  <svg width="60" height="40" viewBox="0,0,60,30">
                    <use xlink:href="#legend" class="up" />
                  </svg>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="btn btn-primary" onclick="compareSubmit();">Submit</button>
        </div>
      </div>
    </div>
    <div class="col-md-4 col-xs-12">
      <table class="table">
        <tbody>
          <tr>
            <td></td>
            <td> Unclear </td>
            <td></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="unclear" />
              </svg>
            </td>
          </tr>
          <tr>
            <td></td>
            <td> None </td>
            <td></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="none" />
              </svg>
            </td>
          </tr>
          <tr>
            <td></td>
            <td> x < </td>
            <td><input id="level1_value" type="number" min="0" value="0.1" onchange="changeLegendValue(this)" /></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="level1" />
              </svg>
            </td>
          </tr>
          <tr>
            <td><input disabled id="level1_value_" type="number" value="0.1" /></td>
            <td> ≦ x < </td>
            <td><input id="level2_value" type="number" min="0" value="1" onchange="changeLegendValue(this)" /></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="level2" />
              </svg>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="col-md-4 col-xs-12">
      <table class="table">
        <tbody>
          <tr>
            <td><input disabled id="level2_value_" type="number" value="1" /></td>
            <td> ≦ x < </td>
            <td><input id="level3_value" type="number" min="0" value="4" onchange="changeLegendValue(this)" /></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="level3" />
              </svg>
            </td>
          </tr>
          <tr>
            <td><input disabled id="level3_value_" type="number" value="4" /></td>
            <td> ≦ x < </td>
            <td><input id="level4_value" type="number" min="0" value="20" onchange="changeLegendValue(this)" /></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="level4" />
              </svg>
            </td>
          </tr>
          <tr>
            <td><input disabled id="level4_value_" type="number" value="20" /></td>
            <td> ≦ x < </td>
            <td><input id="level5_value" type="number" min="0" value="100" onchange="changeLegendValue(this)" /></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="level5" />
              </svg>
            </td>
          </tr>
          <tr>
            <td><input disabled id="level5_value_" type="number" value="100" /></td>
            <td> ≦ x </td>
            <td></td>
            <td>
              <svg width="60" height="40" viewBox="0,0,60,30">
                <use xlink:href="#legend" class="level6" />
              </svg>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <br>
  <div class="row">
    <div class="col-md-3 col-xs-12"></div>
    <div class="col-md-9 col-xs-12">
      <div class="parent-tab-content">
        <ul class="nav nav-tabs sub-tab active" id="LLO-menu">
          <li class="nav-item"><a id="LLO-def" class="nav-link active" data-toggle="tab"
              href="#LLO-def-image">default</a></li>
          <!-- <li class="nav-item"><a id="GPI-def" class="nav-link" data-toggle="tab" href="#GPI">Link</a></li> -->
        </ul>
        <ul class="nav nav-tabs sub-tab" id="HMO_biosynthesis-menu">
          <li class="nav-item"><a id="HMO_biosynthesis-def" class="nav-link active" data-toggle="tab"
              href="#HMO_biosynthesis-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="N-glycan_processing-menu">
          <li class="nav-item"><a id="N-glycan_processing-def" class="nav-link active" data-toggle="tab"
              href="#N-glycan_processing-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Complex_capping-menu">
          <li class="nav-item"><a id="Complex_capping-def" class="nav-link active" data-toggle="tab"
              href="#Complex_capping-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GPI-menu">
          <li class="nav-item"><a id="GPI-def" class="nav-link active" data-toggle="tab"
              href="#GPI-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Mucin-O-glycan-menu">
          <li class="nav-item"><a id="Mucin-O-glycan-def" class="nav-link active" data-toggle="tab"
              href="#Mucin-O-glycan-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Other-O-glycan_C-Man-menu">
          <li class="nav-item"><a id="Other-O-glycan_C-Man-def" class="nav-link active" data-toggle="tab"
              href="#Other-O-glycan_C-Man-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="O-Man-menu">
          <li class="nav-item"><a id="O-Man-def" class="nav-link active" data-toggle="tab"
              href="#O-Man-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GAG-menu">
          <li class="nav-item"><a id="GAG-def" class="nav-link active" data-toggle="tab"
              href="#GAG-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Heparan_sulfate-menu">
          <li class="nav-item"><a id="Heparan_sulfate-def" class="nav-link active" data-toggle="tab"
              href="#Heparan_sulfate-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Chondroitin_sulfate_Dermatan_sulfate-menu">
          <li class="nav-item"><a id="Chondroitin_sulfate_Dermatan_sulfate-def" class="nav-link active"
              data-toggle="tab" href="#Chondroitin_sulfate_Dermatan_sulfate-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Keratan_sulfate-menu">
          <li class="nav-item"><a id="Keratan_sulfate-def" class="nav-link active" data-toggle="tab"
              href="#Keratan_sulfate-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GSLs_core-menu">
          <li class="nav-item"><a id="GSLs_core-def" class="nav-link active" data-toggle="tab"
              href="#GSLs_core-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GSLs_Globosides-menu">
          <li class="nav-item"><a id="GSLs_Globosides-def" class="nav-link active" data-toggle="tab"
              href="#GSLs_Globosides-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GSLs_Gangliosides-menu">
          <li class="nav-item"><a id="GSLs_Gangliosides-def" class="nav-link active" data-toggle="tab"
              href="#GSLs_Gangliosides-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Sugar_Nucleotides-menu">
          <li class="nav-item"><a id="Sugar_Nucleotides-def" class="nav-link active" data-toggle="tab"
              href="#Sugar_Nucleotides-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="Hyaluronic_acid-menu">
          <li class="nav-item"><a id="Hyaluronic_acid-def" class="nav-link active" data-toggle="tab"
              href="#Hyaluronic_acid-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="N-glycan_degradation-menu">
          <li class="nav-item"><a id="N-glycan_degradation-def" class="nav-link active" data-toggle="tab"
              href="#N-glycan_degradation-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GSLs_degradation-menu">
          <li class="nav-item"><a id="GSLs_degradation-def" class="nav-link active" data-toggle="tab"
              href="#GSLs_degradation-def-image">default</a></li>
        </ul>
        <ul class="nav nav-tabs sub-tab" id="GAG_degradation-menu">
          <li class="nav-item"><a id="GAG_degradation-def" class="nav-link active" data-toggle="tab"
              href="#GAG_degradation-def-image">default</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3 col-xs-12" >
      <div style="width:100%;height:500px;overflow-y:scroll;overflow-x:none;">
        <ul class="nav flex-column nav-pills parent-tab" id="myTab" role="tablist" aria-orientation="vertical">
          <li class="nav-item">
            <a class="nav-link active" data-value="01-02_LLO.svg" id="LLO-tab" data-toggle="tab" href="#LLO-menu" role="tab"
              aria-controls="LLO-menu" aria-selected="true" data-target="#chart-01, #chart-02">LLO biosynthesis
              and OST</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="03_N-glycan_processing.svg" id="N-glycan_processing-tab" data-toggle="tab"
              href="#N-glycan_processing-menu" role="tab" aria-controls="N-glycan_processing-menu" aria-selected="false"
              data-target="#chart-03">N-glycan processing and branching</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="04_Complex_capping.svg" id="Complex_capping-tab" data-toggle="tab"
              href="#Complex_capping-menu" role="tab" aria-controls="Complex_capping-menu" aria-selected="false"
              data-target="#chart-04">Complex capping N-glycans/O-glycans/GSLs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="05_GPI.svg" id="GPI-tab" data-toggle="tab" href="#GPI-menu" role="tab"
              aria-controls="GPI-menu" aria-selected="false" data-target="#chart-05">Biosynthesis of GPI-APs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="06_Mucin-O-glycan.svg" id="Mucin-O-glycan-tab" data-toggle="tab"
              href="#Mucin-O-glycan-menu" role="tab" aria-controls="Mucin-O-glycan-menu" aria-selected="false"
              data-target="#chart-06">Biosynthesis of mucin-type O-glycans</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="07-08_Other-O-glycan_C-Man.svg" id="Other-O-glycan_C-Man-tab" data-toggle="tab"
              href="#Other-O-glycan_C-Man-menu" role="tab" aria-controls="Other-O-glycan_C-Man-menu" aria-selected="false"
              data-target="#chart-07, #chart-08">Biosynthesis of
              O-Fuc/O-Glc/Col-Gal/O-GlcNAc/C-Man</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="07_O-Man.svg" id="O-Man-tab" data-toggle="tab" href="#O-Man-menu" role="tab"
              aria-controls="O-Man-menu" aria-selected="false" data-target="#chart-07">Biosynthesis of O-Man</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="09_GAG.svg" id="GAG-tab" data-toggle="tab" href="#GAG-menu" role="tab"
              aria-controls="GAG-menu" aria-selected="false" data-target="#chart-09">Biosynthesis of GAG</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="10_Heparan_sulfate.svg" id="Heparan_sulfate-tab" data-toggle="tab"
              href="#Heparan_sulfate-menu" role="tab" aria-controls="Heparan_sulfate-menu" aria-selected="false"
              data-target="#chart-10">Biosynthesis of Heparan sulfate (HS)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="11_Chondroitin_sulfate_Dermatan_sulfate.svg"
              id="Chondroitin_sulfate_Dermatan_sulfate-tab" data-toggle="tab" href="#Chondroitin_sulfate_Dermatan_sulfate-menu"
              role="tab" aria-controls="Chondroitin_sulfate_Dermatan_sulfate-menu" aria-selected="false"
              data-target="#chart-11">Biosynthesis of Chondroitin sulfate (CS) and dermatan sulfate (DS)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="12_Keratan_sulfate.svg" id="Keratan_sulfate-tab" data-toggle="tab"
              href="#Keratan_sulfate-menu" role="tab" aria-controls="Keratan_sulfate-menu" aria-selected="false"
              data-target="#chart-12">Biosynthesis of Keratan sulfate (KS)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="23_Hyaluronic_acid.svg" id="Hyaluronic_acid-tab" data-toggle="tab"
              href="#Hyaluronic_acid-menu" role="tab" aria-controls="Hyaluronic_acid-menu" aria-selected="false"
              data-target="#chart-23">Biosynthesis and Catabolism of Hyaluronan</a>
          </li><li class="nav-item">
            <a class="nav-link" data-value="14_GSLs_core.svg" id="GSLs_core-tab" data-toggle="tab" href="#GSLs_core-menu"
              role="tab" aria-controls="GSLs_core-menu" aria-selected="false" data-target="#chart-14">Biosynthesis of
              Glycosphingolipids (core)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="15_GSLs_Globosides.svg" id="GSLs_Globosides-tab" data-toggle="tab"
              href="#GSLs_Globosides-menu" role="tab" aria-controls="GSLs_Globosides-menu" aria-selected="false"
              data-target="#chart-15">Biosynthesis of Globosides (Gbs)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="16_GSLs_Gangliosides.svg" id="GSLs_Gangliosides-tab" data-toggle="tab"
              href="#GSLs_Gangliosides-menu" role="tab" aria-controls="GSLs_Gangliosides-menu" aria-selected="false"
              data-target="#chart-16">Biosynthesis of Gangliosides</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="18_Sugar_Nucleotides.svg" id="Sugar_Nucleotides-tab" data-toggle="tab"
              href="#Sugar_Nucleotides-menu" role="tab" aria-controls="Sugar_Nucleotides-menu" aria-selected="false"
              data-target="#chart-18">Biosynthesis of Sugar nucleotide</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="28_N-glycan_degradation.svg" id="N-glycan_degradation-tab" data-toggle="tab"
              href="#N-glycan_degradation-menu" role="tab" aria-controls="N-glycan_degradation-menu" aria-selected="false"
              data-target="#chart-28">Lysosomal degradation of N-glycans</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="29_GSLs_degradation.svg" id="GSLs_degradation-tab" data-toggle="tab"
              href="#GSLs_degradation-menu" role="tab" aria-controls="GSLs_degradation-menu" aria-selected="false"
              data-target="#chart-29">Lysosomal degradation of GSLs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="30_GAG_degradation.svg" id="GAG_degradation-tab" data-toggle="tab"
              href="#GAG_degradation-menu" role="tab" aria-controls="GAG_degradation-menu" aria-selected="false"
              data-target="#chart-30">Lysosomal degradation of GAGs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="37_HMO_biosynthesis.svg" id="HMO_biosynthesis-tab" data-toggle="tab"
              href="#HMO_biosynthesis-menu" role="tab" aria-controls="HMO_biosynthesis-menu" aria-selected="false"
              data-target="#chart-37">Human milk oligosaccharides(HMO) biosynthesis</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Transporter-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="chart-19" aria-selected="false" data-target="#chart-19">Transporter</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Golgi_homeostasis-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="chart-20" aria-selected="false" data-target="#chart-20">Golgi homeostasis</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Lectin-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-21" aria-selected="false" data-target="#chart-21">Lectin</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Glycogen-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-22" aria-selected="false" data-target="#chart-22">Glycogen</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Sulfate_Related-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-27" aria-selected="false" data-target="#chart-27">Sulfate Related</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="GPI-anchored_protein-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-31" aria-selected="false" data-target="#chart-31">GPI-anchored protein</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Proteoglycan_protein-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-32" aria-selected="false" data-target="#chart-32">Proteoglycan protein</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Glycosyltransferase-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-34" aria-selected="false" data-target="#chart-34">Glycosyltransferase</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Glycosylhydrolase-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-35" aria-selected="false" data-target="#chart-35">Glycosylhydrolase</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-value="" id="Carbohydrate_Binding_Module-tab" data-toggle="tab" href="#no-image" role="tab"
              aria-controls="#chart-36" aria-selected="false" data-target="#chart-36">Carbohydrate Binding
              Module</a>
          </li>
        </ul>
      </div>

      
    </div>

    <!-- パネル部分 -->
    <div class="col-md-9 col-xs-12">
      <div class="zoom-svg-container">
        <svg class="tab-content" id="pathway_area" width="100%" height="100%">
          <svg id="no-image" class="tab-pane" role="tabpanel" viewBox="0 0 200 100" xmlns="http://www.w3.org/2000/svg">
            <text x="50%" y="50%" text-anchor="middle" dominant-baseline="central">No Image</text>
          </svg>
        </svg>
        <div class="zoom-svg-zoom zoom-svg-zoom-in"> + </div>
        <div class="zoom-svg-zoom zoom-svg-zoom-rst"> = </div>
        <div class="zoom-svg-zoom zoom-svg-zoom-out"> - </div>
        <div class="zoom-svg-zoom zoom-svg-zoom-delete" onclick="deleteTab()"> × </div>
      </div>
      <button id="downloadImageButton" type="button" onclick="generateImage()">Download Image</button>
      <a href="javascript:showlegend()">Legend</a>
      <div id="chart_area" class="chart-tab-content"></div>
    </div>
  </div>

  <script>
    /* local */
    var address = "http://localhost:8888/";
    /* deploy test */
    // var address = "https://test.glycomaple.glycosmos.org/";
    /* deploy prod */
    // var address = "https://glycomaple.glycosmos.org/";
    // var address = "http://150.37.132.77:8886/";

    
    var repeat_type = []

    var activeSubTab

    function addtab (data, type, tab) {
      return data.replace(type,type + "1")
    } //for submit repeated name of cells

    function showlegend() {
      window.open(address + "default/symbol.svg", "_blank", "width=313,height=345");
    }

    function showAllPathway(key, value, type, tab, hpa = false) {
      var id = key + "-" + type;
      value = value.replace('<svg', '<svg id="' + id + '-image" class="tab-pane" role="tabpanel" aria-labelledby="' + id + '" ');
      if (key === tab.split("-").slice(0, -1).join("-") && !hpa) {
        value = value.replace('tab-pane', 'tab-pane active');
      }
      $("#pathway_area").prepend(value);
    }

    $(function () {

      $('#compare_button').on('click', function () {
        $('.modal').fadeIn();
        $('#SampleA').empty();
        $('#SampleB').empty();
        var activeMenuId = $("#myTab").find("li > a.active").attr("href");
        var samples = [];
        $(activeMenuId + " li").text(function (index, text) {
          samples.push(text);
        });
        $('#SampleA').append(function () {
          var optionAll = "";
          for (var sample of samples) {
            if ($("#SampleA option[value='" + sample + "']").length == 0) {
              if (sample == "default") continue;
              else if (sample.match(/ vs /)) continue;
              else var option = "<option value='" + sample + "'>" + sample + "</option>";
              optionAll += option;
            }
          }
          $('#SampleB').append(optionAll);
          return optionAll;
        });
      });
      $('.modal-close').on('click', function () {
        $('.modal').fadeOut();
        return false;
      });

      $('div.parent-tab-content').on('shown.bs.tab', function (e) {
        $('div.parent-tab-content ul[class="nav nav-tabs sub-tab"]>li>a').removeClass("active")
        $('div.parent-tab-content ul[class="nav nav-tabs sub-tab"]>li>a').removeClass("show")
        activeSubTab = exchangeId($(e.target).text(), 0)
      });

      $('ul.parent-tab a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
        // $('#pathway_area svg.active').removeClass("active")
        setActive($(e.target));
      });

      function setActive(targetObj) {
        $('#pathway_area svg.active').removeClass("active");
        targetMenuId = targetObj.attr("href");
        targetTabId = $(targetMenuId).find("li > a.active").first().attr("href");
        if (!targetTabId) {
          $(targetMenuId).find('li>a' + targetMenuId.substring(0, targetMenuId.length - 5) + '-' + activeSubTab).addClass("active");
          targetTabId = $(targetMenuId).find('li>a' + targetMenuId.substring(0, targetMenuId.length - 5) + '-' + activeSubTab).attr("href");
        }
        $(targetTabId).addClass('active');
        var targetImageId = $(targetTabId).find("li").first().find("a").attr("href");

        $(".parent-tab-content > .sub-tab.active").removeClass('active');
        $(targetMenuId).addClass('active');

        $('#chart_area div.active').removeClass("active");
        targetChart = targetObj.attr("data-target");
        $(targetChart).addClass("active");
      }

      $.ajax({
        type: "GET",
        url: address + "all",
        scriptCharset: "utf-8",
      })
        .done(function (result) {
          result = JSON.parse(result);
          var activeTab = $("#myTab > li > a.active").attr("id")
          for (var key in result) {
            showAllPathway(key, result[key], "def", activeTab);
          }
          $("#pathway_area").zoomSvg();
        })
        .fail(function (data, jqXHR, textStatus, errorThrown) {
          alert(jqXHR + " (" + textStatus + ")");
        })

      $.ajax({
        type: "GET",
        url: address + "hpa/list",
        scriptCharset: "utf-8",
      })
        .done(function (result) {
          result = JSON.parse(result);
          for (var cell of result["cells"]) {
            $("#hpa_cells").append('<option value="' + cell + '">' + cell + '</option>')
          }
          for (var tissue of result["tissue"]) {
            $("#hpa_tissue").append('<option value="' + tissue + '">' + tissue + '</option>')
          }
        })
        .fail(function (data, jqXHR, textStatus, errorThrown) {
          alert(jqXHR + " (" + textStatus + ")");
        });
    });
  </script>



  <script type="text/javascript">
    function changeLegendValue(_this) {
      var id = _this.id;
      var value = _this.value;
      $("#" + id + "_").val(value)
    }

    function deleteTab() {
      var id = $(".parent-tab-content > .sub-tab.active > li > .nav-link.active").attr("id");
      // var id = $(_this).parent().attr("id");
      var nextMenuId = $("#" + id).parents(".sub-tab").find("li").first().find("a").attr("id");
      var nextImageId = $("#" + nextMenuId).attr("href");
      $("#" + nextMenuId).addClass("active");
      $(nextImageId).addClass("active");
      $("#" + id).unwrap().remove();
      $("#" + id + "-image").remove();
    }

    function exchangeId(id_str, flag) {
      if (flag === 0) { return id_str.replace(/\//g, "SLASH").replace(/\s/g, "SPACE").replace(/\+/g, "PLUS"); }
      else if (flag === 1) { return id_str.replace(/SLASH/g, "/").replace(/SPACE/g, " ").replace(/PLUS/g, "+"); }
      else { return id_str }
    }

    function hpaAdd(cells_tissue) {
      var type = exchangeId($("#hpa_" + cells_tissue).val(), 0);
      var id = type;

      var complex = $("#complex_ope").val();
      var overlap = $("#overlap_ope").val();
      var value_range = ""
      for (var i = 1; i < 6; i++) {
        var v = $("#level" + i + "_value").val() + ","
        if (v === ",") {
          break
        }
        value_range += v
      }

      if (i < 5) {
        alert("Please input number of value range.")
      }
      else if ($("#LLO-" + id).length != 0) {
        alert("Already exists.");
      }
      else {
        $.ajax({
          type: "POST",
          url: address + "hpaall",
          scriptCharset: "utf-8",
          contentType: "application/json",
          data: JSON.stringify({ "type": type, "cells_tissue": cells_tissue, "complex": complex, "overlap": overlap, "value_range": value_range }),
          dataType: "json",
          beforeSend: function () {
            $("#file_loading").fadeIn();
          }
        })
          .done(function (result) {
            if ($("#chart_area > div > div").length == 0) {
              // console.log('no-chart')
              // result = JSON.parse(result)
              $("#pathway_area").empty();
              $("#chart_area").empty()
              var activeTab = $("#myTab > li > a.active").attr("id")

              for (var key in result["svg"]) {
                //id = exchangeId(type, 0)
                $("#" + key + "-menu").empty();
                $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link active" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + exchangeId(type, 1) + '</a></li>')
                $("#" + key + '-' + id).tooltip();
                showAllPathway(key, result["svg"][key], id, activeTab);
              }
              var activeChart = $("#" + activeTab).attr("data-target")
              for (var cate in result["chart"]) {
                var chartId = "chart-" + cate
                if (activeChart.includes(chartId)) {
                  $("#chart_area").append('<div id="' + chartId + '" class="chart-panel active show"></div>')
                }
                else {
                  $("#chart_area").append('<div id="' + chartId + '" class="chart-panel"></div>')
                }
                var data = []
                var trace = {
                  y: result["chart"][cate]["x"].reverse(),
                  x: result["chart"][cate]["y"].reverse(),
                  type: 'bar',
                  orientation: 'h',
                  name: exchangeId(type, 1),
                  // colorscale: ["NaN", "gray"]
                }
                data.push(trace)
                var len = data[0]["y"].length * 40 + 200
                var layout = {
                  // title: category,
                  showlegend: true,
                  height: len,
                  yaxis: {
                    automargin: true
                  },
                  autosize: true
                };
                Plotly.newPlot('chart-' + cate, data, layout, { responsive: true });
              }

            }
            else {
              //console.log('chart-exist')
              var activeTab = $("#myTab > li > a.active").attr("id")
              for (var key in result["svg"]) {
                $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + exchangeId(type, 1) + '</a></li>')
                $("#" + key + '-' + id).tooltip();
                showAllPathway(key, result["svg"][key], id, activeTab, true);
              }

              for (var cate in result["chart"]) {
                var chartId = "#chart-" + cate
                var trace = {
                  y: result["chart"][cate]["x"].reverse(),
                  x: result["chart"][cate]["y"].reverse(),
                  type: 'bar',
                  orientation: 'h',
                  name: exchangeId(type, 1),
                  // colorscale: ["NaN", "gray"]
                }
                Plotly.addTraces(chartId.split("#")[1], trace);
              }
            }
          })
          .fail(function (data, jqXHR, textStatus, errorThrown) {
            alert(jqXHR + " (" + textStatus + ")");
          })
          .always(function () {
            $("#file_loading").fadeOut();
          });
      }
    }



    function fileSubmit() {
      value_range = ""
      for (var i = 1; i < 6; i++) {
        var v = $("#level" + i + "_value").val() + ","
        if (v === ",") {
          break
        }
        value_range += v
      }
      if (i < 5) {
        alert("Please input number of value range.")
      }
      else if (document.getElementById("seqFile").files.length == 0) {
        alert("Please input .csv file.");
      }
      else {
        var file = $('#seqFile')[0].files[0];
        if (!file.name.match('.csv$')) {
          alert('Please select .csv file.');
          return;
        }
        var reader = new FileReader();
        reader.readAsText(file);
        reader.onload = function () {
          var input_csv = reader.result
          var complex = $("#complex_ope").val(); 
          var overlap = $("#overlap_ope").val();
          var type_name = input_csv.split("\r\n")[0].split(",")
          for (var i = 0; i < type_name.length; i++) {
            if (type_name.indexOf(type_name[i]) !== type_name.lastIndexOf(type_name[i])) {
              alert("Duplicate sample name: " + type_name[i]);
              return;
            }
          }                    
          for (i = 1, len = type_name.length; i < len; i++) {
            var type = type_name[i]
            id=  exchangeId(type, 0);
            if ($("#LLO-" + id).length != 0) {
              if (repeat_type[type] == undefined){
                input_csv = input_csv.replace(type, type + "-1")
                repeat_type[type]= 1
                repeat_type[type] += 1
              }
              else{
                input_csv = input_csv.replace(type, type + "-" + repeat_type[type])
                repeat_type[type] += 1
              }
            }
          }
          $.ajax({
            type: "POST",
            url: address + "newall",
            data: JSON.stringify({ "file": input_csv, "complex": complex, "overlap": overlap, "value_range": value_range }),
            contentType: "application/json",
            scriptCharset: "utf-8",
            dataType: "json",
            beforeSend: function () {
              $("#file_loading").fadeIn();
            }
          })
            .done(function (result) {
              if (result["error"].length !== 0) {
                alert("Error in these genes: " + result["error"]);
              }
              if ($("#chart_area > div > div").length == 0) {
                
                //console.log("no-chart")
                // result = JSON.parse(result)
                $("#pathway_area").empty();
                $("#chart_area").empty()
                

                var activeTab = $("#myTab > li > a.active").attr("id")
                
                isFirst = true;
                for (var type in result["svg"]) {
                  if ($("#pathway_area > svg > g").length == 0) { 
                    for (var key in result["svg"][type]) {
                      id = exchangeId(type, 0)
                      if (isFirst) {
                        $("#" + key + "-menu").empty();
                        $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link active" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + type + '</a></li>')
                      }
                      else {
                        $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + type + '</a></li>')
                      }
                      $("#" + key + '-' + id).tooltip();
                      showAllPathway(key, result["svg"][type][key], id, activeTab);
                      //console.log("no-image")
                    }
                    isFirst = false;
                  }
                  else {
                    for (var key in result["svg"][type]) {
                      id = exchangeId(type, 0)
                      if (isFirst) {
                        $("#" + key + "-menu").empty();
                        $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link active" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + type + '</a></li>')
                      }
                      else {
                        $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + type + '</a></li>')
                      }
                      $("#" + key + '-' + id).tooltip();
                      showAllPathway(key, result["svg"][type][key], id, activeTab,true);
                      //console.log("image-exist")
                    }
                    isFirst = false;
                  }
                }
                var activeChart = $("#" + activeTab).attr("data-target")
                for (var category in result["chart"]) {
                  var chartId = "chart-" + category
                  if (activeChart.includes(chartId)) {
                    $("#chart_area").append('<div id="' + chartId + '" class="chart-panel active show"></div>')
                  }
                  else {
                    $("#chart_area").append('<div id="' + chartId + '" class="chart-panel"></div>')
                  }
                  var data = []
                  for (var type in result["chart"][category]) {
                    var trace = {
                      y: result["chart"][category][type]["x"].reverse(),
                      x: result["chart"][category][type]["y"].reverse(),
                      type: 'bar',
                      orientation: 'h',
                      name: type,
                      // colorscale: ["NaN", "gray"]
                    }
                    data.push(trace)
                  }
                  var len = data[0]["y"].length * 40 + 200
                  var layout = {
                    // title: category,
                    showlegend: true,
                    height: len,
                    yaxis: {
                      automargin: true
                    },
                    autosize: true
                  };
                  Plotly.newPlot('chart-' + category, data, layout, { responsive: true });
                }
              }
              else {
                //console.log('chart-exist')
                // result = JSON.parse(result)
                var activeTab = $("#myTab > li > a.active").attr("id")
                if (result["error"].length !== 0) {
                  alert("Error in these genes: " + result["error"]);
                }
                isFirst = true;
                for (var type in result["svg"]) {
                  for (var key in result["svg"][type]) {
                    id = exchangeId(type, 0)
                    $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + type + '</a></li>')
                    $("#" + key + '-' + id).tooltip();
                    showAllPathway(key, result["svg"][type][key], id, activeTab, true);
                  }
                }
                for (var category in result["chart"]) {
                  var chartId = "#chart-" + category
                  for (var type in result["chart"][category]) {
                    var trace = {
                      y: result["chart"][category][type]["x"].reverse(),
                      x: result["chart"][category][type]["y"].reverse(),
                      type: 'bar',
                      orientation: 'h',
                      name: type,
                      // colorscale: ["NaN", "gray"]
                    }
                    Plotly.addTraces(chartId.split("#")[1], trace);
                  }
                }
              }
            })
            .fail(function (data, jqXHR, textStatus, errorThrown) {
              alert(jqXHR + " (" + textStatus + ")");
            })
            .always(function () {
              $("#file_loading").fadeOut();
            });
        };
      }
    }

    function compareSubmit() {
      var down_value = $("#down_value").val();
      var up_value = $("#up_value").val();
      var sampleA = $("#SampleA").val();
      var sampleB = $("#SampleB").val();
      var complex = $("#complex_com").val();
      var overlap = $("#overlap_com").val();

      if (down_value === "" || up_value === "") {
        alert("Please input number of value range.")
      }
      else if (sampleA === "" || sampleB === "" || sampleA === sampleB) {
        alert("Please select two different samples.")
      }
      else {
        // var data = {"A": {"name": sampleA, "value": {}}, "B": {"name": sampleB, "value": {}}, "complex": complex, "overlap": overlap, "down": down_value, "up": up_value};
        var data = { "A": sampleA, "B": sampleB, "complex": complex, "overlap": overlap, "down": down_value, "up": up_value };
        data[sampleA] = {};
        data[sampleB] = {};
        $('#chart_area > div').each(function (index, element) {
          var chart = document.getElementById(element.id)
          chart.data.forEach(function (trace) {
            if (trace.name === sampleA || trace.name === sampleB) {
              var sample = trace.name;
              var len = Math.min(trace.x.length, trace.y.length)
              for (var i = 0; i < len; i++) {
                var x = trace.x[i];
                var y = trace.y[i].split(" ")[1];
                data[sample][y] = x
              }
            }
          });
        });
        $.ajax({
          type: "POST",
          url: address + "compareall",
          data: JSON.stringify(data),
          contentType: "application/json",
          scriptCharset: "utf-8",
          dataType: "json",
        })
          .done(function (result) {
            var type = sampleA + " vs " + sampleB;
            var id = exchangeId(type, 0);
            var id2 = id
            
            if ($("#LLO-" + id).length != 0) {
              if (repeat_type[id2] == undefined) {
                type = type + "-1"
                id = id + "-1"
                repeat_type[id2] = 1
                repeat_type[id2] += 1
              }
              else {
                type= type + "-" + repeat_type[id2]
                id = id + "-" + repeat_type[id2]
                repeat_type[id2] += 1
              }
            }
              
                
            

            

            var activeTab = $("#myTab > li > a.active").attr("id")
            for (var key in result["svg"]) {
              $("#" + key + "-menu").append('<li class="nav-item"><a id="' + key + '-' + id + '" class="nav-link" data-toggle="tab" href="#' + key + '-' + id + '-image" title="complex:' + complex + ' overlap:' + overlap + '">' + type + '</a></li>')
              $("#" + key + '-' + id).tooltip();
              showAllPathway(key, result["svg"][key], id, activeTab, true);
            }
          })
          .fail(function (data, jqXHR, textStatus, errorThrown) {
            alert(jqXHR + " (" + textStatus + ")");
          })
          .always(function () {
            $('.modal').fadeOut();
          });
      }
    }


    function generateImage() {
      function editSVG(level) {
        var arrows = $("." + level);
        var f = arrows.css("fill");
        var s = arrows.css("stroke");
        var sw = arrows.css("stroke-width");
        arrows.attr({ "fill": f, "stroke": s, "stroke-width": sw });
      }

      for (var i = 1; i <= 6; i += 1) {
        editSVG("level" + i);
      }
      editSVG("none");
      editSVG("unclear");
      editSVG("down");
      editSVG("up");

      var id = $('svg.active').attr("id")
      // var width = $("#"+id).width()
      // var height = $("#"+id).height()
      var width = 3500
      var height = 3500
      $("body").append('<canvas id="canvas" class="hidden" style="display:none" width='
        + width + ' height=' + height + '></canvas>')

      var canvas = $("#canvas")[0]
      var ctx = canvas.getContext("2d")

      var svg = $("#" + id)
      // svg.attr("viewBox", "0 0 " + width + " " + height)

      var data = new XMLSerializer().serializeToString(svg[0])
      var imgsrc = "data:image/svg+xml;charset=utf-8;base64,"
        + btoa(unescape(encodeURIComponent(data)))
      var image = new Image()
      image.onload = function () {

        ctx.drawImage(image, 0, 0);
        // console.log(canvas.toDataURL("image/png"))
        // window.open(canvas.toDataURL("image/png"), "imgwindow");
        // Optional: 自動でダウンロードさせる場合
        $("body").append("<a id='image-file' class='hidden' type='application/octet-stream' href='"
          + canvas.toDataURL("image/png") + "' download='" + id + ".png'>Download Image</a>")
        $("#image-file")[0].click()

        // 後処理
        $("#canvas").remove()
        $("#image-file").remove()

      }
      image.src = imgsrc;
    }
  </script>

  <style>
    /* #file_loading{
        position: fixed;
        top: 0;
        z-index: 100;
        width: 100%;
        height:100%;
        display: none;
        background: rgba(0,0,0,0.6);
    } */
    .cv-spinner {
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px #ddd solid;
      border-top: 4px #2e93e6 solid;
      border-radius: 50%;
      animation: sp-anime 0.8s infinite linear;
    }

    @keyframes sp-anime {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(359deg);
      }
    }

    input {
      width: 50px
    }

    .unclear {
      fill: #0000FF;
      stroke: #0000FF;
      stroke-width: 1;
    }

    .none {
      fill: #9932CC;
      stroke: #9932CC;
      stroke-width: 1;
    }

    .level1 {
      fill: #FFC0CB;
      stroke: #FFC0CB;
      stroke-width: 1;
    }

    .level2 {
      fill: #CC0000;
      stroke: #CC0000;
      stroke-width: 1;
    }

    .level3 {
      fill: #000000;
      stroke: #000000;
      stroke-width: 1;
    }

    .level4 {
      fill: #000000;
      stroke: #000000;
      stroke-width: 3;
    }

    .level5 {
      fill: #000000;
      stroke: #000000;
      stroke-width: 5;
    }

    .level6 {
      fill: #000000;
      stroke: #000000;
      stroke-width: 8;
    }

    .up {
      fill: deeppink;
      stroke: deeppink;
      stroke-width: 5;
    }

    .down {
      fill: green;
      stroke: green;
      stroke-width: 5;
    }


    .modal {
      display: none;
      height: 100vh;
      position: fixed;
      top: 0;
      width: 100%;
    }

    .modal_bg {
      background: rgba(0, 0, 0, 0.8);
      height: 100vh;
      position: absolute;
      width: 100%;
    }

    .modal_content {
      background: #fff;
      left: 50%;
      padding: 40px;
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 60%;
    }



    .parent-tab-content>ul.sub-tab {
      display: none;
    }

    .parent-tab-content>ul.sub-tab.active {
      display: flex;
    }

    .chart-tab-content>.chart-panel {
      display: none;
    }

    .chart-tab-content>.chart-panel.active {
      display: flex;
    }


    /* *
     * @license zoom-svg.css v1.0
     * Updated: Mon Feb 20 2017
     * First Release
     * Copyright (c) Laurent SOUEF Consulting
     * Released under the MIT license
     * https://github.com/LaurentSouefConsulting/jquery.zoom-svg/blob/master/MIT-License.txt
     */
    .zoom-svg-container {
      position: relative;
      display: block;
      background-color: #fff;
      border: 2px solid #333;
      width: 100%;
      height: 500px;
      overflow: hidden;

    }

    .zoom-svg-container:hover svg {
      cursor: move;
    }

    .zoom-svg-zoom {
      background-color: grey;
      border: 2px solid #666;
      color: white;
      height: 22px;
      line-height: 18px;
      text-align: center;
      border-radius: 3px;
      font-size: 16px;
      cursor: pointer;
      outline: none;
      user-select: none;
      -webkit-user-select: none;
      /* Chrome all / Safari all */
      moz-user-select: none;
      /* Firefox all */
      -ms-user-select: none;
      /* IE 10+ */
    }

    .zoom-svg-zoom-in {
      position: absolute;
      bottom: 70px;
      right: 30px;
      width: 20px;
    }

    .zoom-svg-zoom-rst {
      position: absolute;
      bottom: 40px;
      right: 10px;
      width: 60px;
    }

    .zoom-svg-zoom-out {
      position: absolute;
      bottom: 10px;
      right: 30px;
      width: 20px;
    }

    .zoom-svg-zoom-delete {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 20px;
    }
  </style>

  <script type="text/javascript">
    /**
    * @license jquery.zoom-svg.js v1.0
    * Updated: Mon Feb 20 2017
    * First Release
    * Copyright (c) Laurent SOUEF Consulting
    * Released under the MIT license
    * https://github.com/LaurentSouefConsulting/jquery.zoom-svg/blob/master/MIT-License.txt
    */
    $.fn.zoomSvg = function (options) {
      // Merge with default options
      var options = $.extend({
        step: 5,
      }, options);

      // Return This to implement Chaining Design Pattern
      return this.each(function () {
        // Elements
        var svg = $(this);
        var div = $(this).parent();
        var zoomIn = $(div).find(".zoom-svg-zoom-in");
        var zoomOut = $(div).find(".zoom-svg-zoom-out");
        var zoomRst = $(div).find(".zoom-svg-zoom-rst");

        // ViewBox Ratio
        var userAgent = window.navigator.userAgent.toLowerCase();
        if (userAgent.indexOf('firefox') != -1) {
          var viewRatio = svg["0"].height.baseVal.value / svg["0"].width.baseVal.value;
        }
        else {
          var viewBox = $(svg).prop("viewBox");
          var viewRatio = viewBox.baseVal.height / viewBox.baseVal.width;
        }

        // Params
        var step = options.step;
        var zoom = 100;
        var width = $(svg).width();

        // Fix div size
        var height = Math.round(width * viewRatio);
        $(div).css("width", width);
        $(div).css("height", height);

        // Drag
        $(svg).draggable();

        // Zooms
        $(zoomIn).click(function () {
          zoom += step;
          scale();
        });

        $(zoomOut).click(function () {
          zoom -= step;
          scale();
        });

        $(zoomRst).click(function () {
          zoom = 100;
          $(svg).css({ "top": "0px", "left": "0px" });
          scale();
        });

        // Resize
        $(window).resize(function () {
          $(div).css("width", "100%");
          $(div).css("height", "500px");
          width = $(div).width();
          height = Math.round(width * viewRatio);
          $(div).css("height", height);
        });

        // Wheel
        $(div).mousewheel(function (event) {
          //console.log("Wheel", event.deltaY);
          //if (event.deltaY > 0)
          //  $(zoomIn).trigger("click");
          //else
          //  $(zoomOut).trigger("click");
        });

        // Functions
        var scale = function () {
          $(svg).css("width", zoom + "%");
          $(svg).css("height", zoom + "%");
          $(div).css("width", width);
          $(div).css("height", height);
        };

      })
    };
  </script>
</body>

</html>